(function(t){function e(e){for(var n,s,i=e[0],c=e[1],u=e[2],l=0,d=[];l<i.length;l++)s=i[l],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,s=1;s<a.length;s++){var i=a[s];0!==r[i]&&(n=!1)}n&&(o.splice(e--,1),t=c(c.s=a[0]))}return t}var n={},s={app:0},r={app:0},o=[];function i(t){return c.p+"js/"+({dashboard:"dashboard"}[t]||t)+"."+{dashboard:"645ac3fe"}[t]+".js"}function c(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(t){var e=[],a={dashboard:1};s[t]?e.push(s[t]):0!==s[t]&&a[t]&&e.push(s[t]=new Promise((function(e,a){for(var n="css/"+({dashboard:"dashboard"}[t]||t)+"."+{dashboard:"f4d0a9a8"}[t]+".css",r=c.p+n,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var u=o[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===n||l===r))return e()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){u=d[i],l=u.getAttribute("data-href");if(l===n||l===r)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var n=e&&e.target&&e.target.src||r,o=new Error("Loading CSS chunk "+t+" failed.\n("+n+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=n,delete s[t],h.parentNode.removeChild(h),a(o)},h.href=r;var p=document.getElementsByTagName("head")[0];p.appendChild(h)})).then((function(){s[t]=0})));var n=r[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,a){n=r[t]=[e,a]}));e.push(n[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(h);var a=r[t];if(0!==a){if(a){var n=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+n+": "+s+")",d.name="ChunkLoadError",d.type=n,d.request=s,a[1](d)}r[t]=void 0}};var h=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=n,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(a,n,function(e){return t[e]}.bind(null,n));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var h=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[t.auth?a("Nav"):t._e(),t.auth||!t.auth&&"/login"==t.path?a("v-content",{staticStyle:{"padding-top":"24px"}},[a("router-view")],1):t._e(),t.auth?t._e():a("v-footer",{attrs:{app:""}},[a("span",[t._v("Â© 2019")])])],1)},r=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-navigation-drawer",{attrs:{app:"",clipped:"","mini-variant":t.miniVariant,"expand-on-hover":t.expandOnHover},scopedSlots:t._u([{key:"append",fn:function(){return[a("div",{staticClass:"pa-2"},[a("v-btn",{attrs:{block:"",outlined:""},on:{click:function(e){return t.logout()}}},[t._v("Logout")])],1)]},proxy:!0}]),model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{attrs:{dense:""}},t._l(t.pages,(function(e,n){return a("v-list-item",{key:n,attrs:{link:"",to:e.link}},[a("v-list-item-action",[a("v-icon",[t._v(t._s(e.icon))])],1),a("v-list-item-content",[a("v-list-item-title",[t._v(t._s(e.name))])],1)],1)})),1)],1),a("v-app-bar",{attrs:{flat:"",app:"","clipped-left":"",dense:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),a("v-toolbar-title",[t._v("Weskool")])],1)],1)},i=[],c={name:"Dashboard",components:{},data:function(){return{drawer:null}},methods:{logout:function(){var t=this;this.$http.create({withCredentials:!0}).post("http://localhost:5443/api/logout").then((function(e){!0===e.data.success?(t.$store.dispatch("deauth"),t.$router.push({name:"login"})):window.alert("Cannot logout, server configuration error. Try clearing your cookies")})).catch((function(t){window.alert("Cannot logout, Browser error. Try clearing your cookies instead")}))}},computed:{pages:function(){return this.$store.state.pages},miniVariant:function(){return this.$store.state.miniDrawer},expandOnHover:function(){return this.$store.state.expandOnHover}},created:function(){}},u=c,l=a("2877"),d=a("6544"),h=a.n(d),p=a("40dc"),m=a("5bc1"),f=a("8336"),g=a("a523"),v=a("132d"),b=a("8860"),w=a("da13"),y=a("1800"),k=a("5d23"),C=a("f774"),S=a("2a7f"),x=Object(l["a"])(u,o,i,!1,null,null,null),_=x.exports;h()(x,{VAppBar:p["a"],VAppBarNavIcon:m["a"],VBtn:f["a"],VContainer:g["a"],VIcon:v["a"],VList:b["a"],VListItem:w["a"],VListItemAction:y["a"],VListItemContent:k["a"],VListItemTitle:k["c"],VNavigationDrawer:C["a"],VToolbarTitle:S["a"]});var L={name:"App",components:{Nav:_},data:function(){return{path:window.location.pathname}},computed:{auth:function(){return this.$store.state.auth}},mounted:function(){this.$vuetify.theme.dark=this.$store.state.darkMode}},O=L,$=(a("a819"),a("7496")),V=a("a75b"),q=a("553a"),R=Object(l["a"])(O,s,r,!1,null,"68701fc2",null),T=R.exports;h()(R,{VApp:$["a"],VContent:V["a"],VFooter:q["a"]});a("d3b7");var j=a("8c4f"),E=(a("99af"),a("2909")),M=a("2f62");n["a"].use(M["a"]);var D=new M["a"].Store({strict:!0,state:{auth:!1,searchResults:[],self:{},selfMini:{},darkMode:!0,miniDrawer:!1,expandOnHover:!1,pages:[{name:"Dashboard",icon:"mdi-desktop-mac-dashboard",link:"/dashboard"},{name:"Chat",icon:"mdi-chat",link:"/chat"},{name:"Profile",icon:"mdi-account",link:"/profile"},{name:"Settings",icon:"mdi-cog",link:"/settings"},{name:"ATC",icon:"mdi-network",link:"/atc"}],chat:{chatIndex:null,activeChat:{},struct:{messageStructure:{to:"",from:null,contents:{text:"",image:[],timestamp:""}},participants:[],messages:[]}}},mutations:{authenticate:function(t){t.auth=!0},deauthenticate:function(t){t.auth=!1},setUserDetails:function(t,e){t.self=e;var a=JSON.parse(JSON.stringify(e));t.selfMini={_id:a._id,username:a.username,avatar:a.avatar}},switchMini:function(t){t.miniDrawer=!t.miniDrawer},switchHover:function(t){t.expandOnHover=!t.expandOnHover},switchDark:function(t){t.darkMode=!t.darkMode},selectChat:function(t,e){t.chat.chatIndex=e,t.chat.activeChat=t.self.chats[e]},insertMessage:function(t){var e=t.chat.chatIndex,a=t.chat.singleChats[e];a.messageStructure.from=t.self.id,a.messageStructure.contents.timestamp=Date.now();var n=function(t){var e=JSON.parse(JSON.stringify(t));return e};a.messages.push(n),a.messageStructure.contents.text=null},updateMessage:function(t,e){t.chat.activeChat.messageStructure.contents.text=e.value},insertResults:function(t,e){t.searchResults=Object(E["a"])(e)},makeActive:function(t,e){var a=JSON.parse(JSON.stringify(t.chat.struct));a.participants=[t.selfMini,e],a.messageStructure.from=t.self._id,a.messageStructure.to=e._id,a.messages=[],t.chat.activeChat=a},insertTimestamp:function(t){t.chat.activeChat.messageStructure.contents.timestamp=Date.now()},createChat:function(t,e){t.self.chats.push(e);var a=t.self.chats.length;t.chat.activeChat=t.self.chats[a-1],t.chat.chatIndex=a-1,t.chat.activeChat.messageStructure.contents.text="",t.chat.activeChat.messageStructure.contents.images=[],t.chat.activeChat.messageStructure.contents.timestamp=""},updateChat:function(t,e){t.self.chats[t.chat.chatIndex].messages.push(e),t.chat.activeChat.messageStructure.contents.text="",t.chat.activeChat.messageStructure.contents.images=[],t.chat.activeChat.messageStructure.contents.timestamp=""},newMessage:function(t,e){for(var a=0;a<t.self.chats.length;a++)if(e._id==t.self.chats[a]._id){t.self.chats[a].messages.push(e.messageStructure);break}},appendEmoji:function(t,e){t.chat.activeChat.messageStructure.contents.text=t.chat.activeChat.messageStructure.contents.text.concat(e)}},actions:{auth:function(t){t.commit("authenticate")},deauth:function(t){t.commit("deauthenticate")}},modules:{},getters:{}}),N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{staticClass:"fill-height d-flex justify-center align-center"},[a("v-card",{staticClass:"mx-auto",attrs:{width:"420",height:"520"}},[a("v-toolbar",{staticClass:"d-flex justify-center",attrs:{color:"primary",dark:"",flat:""}},[a("v-toolbar-title",[t._v("WESKOOL")])],1),a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-row",{staticClass:"px-6 py-6",attrs:{"no-gutters":""}},[0==t.requestSuccess?a("v-col",{attrs:{cols:"12",align:"center"}},[a("p",{staticClass:"red--text title"},[t._v(t._s(t.requestResponse))])]):t._e(),a("v-col",{staticClass:"mt-2",attrs:{cols:"12"}},[a("v-text-field",{attrs:{rules:t.nameRules,label:t.signup?"Username":"Username or Email",outlined:"","prepend-inner-icon":"mdi-account"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),a("v-col",{class:t.signup?"email":"emailhide",attrs:{cols:"12"}},[a("v-text-field",{attrs:{rules:t.signup?t.emailRules:[],label:"email",outlined:"",type:"email","prepend-inner-icon":"mdi-email"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),a("v-col",{class:t.signup?"move":"moveback",attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Password",required:"",outlined:"","append-icon":t.show?"mdi-eye":"mdi-eye-off","prepend-inner-icon":"mdi-lock",rules:[t.rules.required,t.rules.min],type:t.show?"text":"password",name:"input-10-1",hint:"At least 8 characters",counter:""},on:{"click:append":function(e){t.show=!t.show}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),a("v-col",{class:t.signup?"move":"moveback",attrs:{cols:"6"}},[a("v-checkbox",{staticClass:"pa-0 ma-0 pt-2",attrs:{label:"Remember me"},model:{value:t.custom,callback:function(e){t.custom=e},expression:"custom"}})],1),a("v-col",{class:t.signup?"move":"moveback",attrs:{cols:"6",align:"right"}},[a("p",{staticClass:"pa-0 ma-0 pt-2"},[a("a",{attrs:{href:"#"}},[t._v("Forgot password")])])]),a("v-col",{staticClass:"py-4 mt-2",attrs:{cols:"4",align:"start",justify:"center"}},[a("v-btn",{class:t.signup?"move login":t.loginLoading?"moveback login glow":"moveback login",attrs:{rounded:"",disabled:t.loginLoading||t.registerLoading,color:t.signup?"grey":"blue"},on:{click:function(e){t.signup?t.signup=!1:t.login()}}},[t._v("Sign In")])],1),a("v-col",{staticClass:"py-4 mt-2",attrs:{cols:"4",align:"center",justify:"center"}},[a("div",{class:t.loginLoading?"lds-ellipsis movebackLoading":t.registerLoading?"lds-ellipsis movebackLoadingReg":"d-none"},[a("div"),a("div"),a("div"),a("div")])]),a("v-col",{staticClass:"py-4 mt-2 register",attrs:{cols:"4",align:"end"}},[a("v-btn",{class:t.signup?t.registerLoading?"move register glow":"move register":"moveback register",attrs:{rounded:"",disabled:t.loginLoading||t.registerLoading,color:t.signup?"blue":"grey"},on:{click:function(e){t.signup?t.register():t.signup=!0}}},[t._v("Sign Up")])],1)],1)],1)],1)],1)},A=[],P={data:function(){return{requestSuccess:null,requestResponse:null,loginLoading:!1,registerLoading:!1,valid:!0,custom:!0,signup:!1,username:"",nameRules:[function(t){return!!t||"Details required"},function(t){return t&&t.length<=40||"Too long"},function(t){return t&&t.length>=3||"Too short"}],email:"",emailRules:[function(t){return!!t||"E-mail is required"},function(t){return/.+@.+\..+/.test(t)||"E-mail must be valid"}],password:"",show:!1,rules:{required:function(t){return!!t||"Required."},min:function(t){return t.length>=8||"Min 8 characters"}}}},methods:{login:function(){if(this.loginLoading=!0,this.requestResponse=null,this.requestSuccess=null,this.$refs.form.validate()){var t=this;this.$http.create({withCredentials:!0}).post("http://localhost:5443/api/login",{username:this.username,password:this.password}).then((function(e){t.loginLoading=!1,t.requestSuccess=e.data.success,t.requestResponse=e.data.message,e.data.success&&(t.$store.dispatch("auth"),t.$store.commit("setUserDetails",e.data.user),t.$openSocket(),Y.push({name:"dashboard"}))}),(function(e){t.loginLoading=!1,t.requestSuccess=!1,t.requestResponse="Server error occurred",console.log(e)}))}else this.loginLoading=!1},register:function(){if(this.registerLoading=!0,this.requestResponse=null,this.requestSuccess=null,this.$refs.form.validate()){var t=this;this.$http.create({withCredentials:!0}).post("http://localhost:5443/api/register",{username:this.username,email:this.email,password:this.password}).then((function(e){t.registerLoading=!1,t.requestSuccess=e.data.success,t.requestResponse=e.data.message,e.data.success&&(t.$store.dispatch("auth"),t.$store.commit("setUserDetails",e.data.user),t.$openSocket(),Y.push({name:"dashboard"}))}),(function(e){t.registerLoading=!1,t.requestSuccess=!1,t.requestResponse="Server error occurred",console.log(e)}))}else this.registerLoading=!1}},created:function(){this.$http.create({withCredentials:!0}).get("http://localhost:5443/api/access").then((function(t){}),(function(t){console.log(t)}))}},I=P,U=(a("80c4"),a("b0af")),B=a("ac7c"),H=a("62ad"),J=a("4bd4"),F=a("0fd9"),z=a("8654"),K=a("71d9"),W=Object(l["a"])(I,N,A,!1,null,"4880c5c0",null),G=W.exports;h()(W,{VBtn:f["a"],VCard:U["a"],VCheckbox:B["a"],VCol:H["a"],VContainer:g["a"],VForm:J["a"],VRow:F["a"],VTextField:z["a"],VToolbar:K["a"],VToolbarTitle:S["a"]}),n["a"].use(j["a"]);var Q=[{path:"/login",name:"login",component:G},{path:"/dashboard",name:"dashboard",component:function(){return a.e("dashboard").then(a.bind(null,"7277"))}},{path:"/chat",name:"chat",component:function(){return a.e("dashboard").then(a.bind(null,"293a"))}},{path:"/settings",name:"settings",component:function(){return a.e("dashboard").then(a.bind(null,"26d3"))}},{path:"/profile",name:"profile",component:function(){return a.e("dashboard").then(a.bind(null,"c66d"))}}],X=new j["a"]({mode:"history",base:"/",saveScrollPosition:!0,routes:Q});X.beforeEach((function(t,e,a){D.state.auth&&"/"==t.path||D.state.auth&&"/login"==t.path?a("/dashboard"):D.state.auth?a():D.state.auth||"/login"==t.path?D.state.auth||"/login"!=t.path||a():a("/login")}));var Y=X,Z=a("f309");n["a"].use(Z["a"]);var tt=new Z["a"]({}),et=a("bc3a"),at=a.n(et),nt=a("8055"),st=a.n(nt),rt=a("123d"),ot=a.n(rt);n["a"].use(ot.a),n["a"].prototype.$http=at.a,n["a"].config.productionTip=!1,n["a"].prototype.$openSocket=function(){n["a"].prototype.$socket=st.a.connect("http://localhost:5443");var t=this.$socket;t.on("response",(function(t){D.commit("insertResults",t)})),t.on("sentResponse",(function(t){!0===t.success&&"new"==t.type?D.commit("createChat",t.data):!0===t.success&&"existing"==t.type&&D.commit("updateChat",t.data)})),t.on("newMessage",(function(t){D.commit("newMessage",t)})),t.on("chatUpdate",(function(t){}))};var it=window.location.pathname;n["a"].prototype.$http.create({withCredentials:!0}).post("http://localhost:5443/api/login/verify").then((function(t){t.data.authorized?(D.commit("setUserDetails",t.data.details),D.dispatch("auth"),n["a"].prototype.$openSocket(),"/login"==it?Y.push({path:"/dashboard"}):Y.push({path:"".concat(it)})):D.dispatch("deauth")})).catch((function(t){D.dispatch("deauth"),console.log(t)})),new n["a"]({router:Y,store:D,vuetify:tt,render:function(t){return t(T)}}).$mount("#app")},"5bde":function(t,e,a){},"80c4":function(t,e,a){"use strict";var n=a("5bde"),s=a.n(n);s.a},a819:function(t,e,a){"use strict";var n=a("c4a4"),s=a.n(n);s.a},c4a4:function(t,e,a){}});
//# sourceMappingURL=app.e2a6db3c.js.map